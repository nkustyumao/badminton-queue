# 🚀 實時同步功能 - 快速測試指南

## 📱 如何測試多裝置同步

### 方法 1：使用兩個瀏覽器視窗（推薦）

1. **開啟第一個視窗**
   ```
   在 Chrome 中打開：http://localhost:3000
   ```

2. **開啟第二個視窗**
   ```
   按 Ctrl+N (Windows) 或 Cmd+N (Mac) 開新視窗
   同樣打開：http://localhost:3000
   ```

3. **並排擺放兩個視窗**
   - 左右各佔一半螢幕
   - 這樣可以同時觀察兩個視窗

4. **在左側視窗進行操作**
   - 新增隊員
   - 新增場地
   - 將隊員加入場地
   - 刪除隊員或場地

5. **觀察右側視窗**
   - **最多 3 秒後**，右側視窗應該自動顯示更新
   - 無需手動刷新頁面 ✅

---

### 方法 2：使用不同裝置

1. **在電腦上開啟**
   ```
   http://localhost:3000
   ```

2. **在手機上開啟**
   - 確保手機和電腦在同一個 Wi-Fi 網路
   - 找到電腦的 IP 位址（例如：192.168.1.100）
   - 在手機瀏覽器打開：`http://192.168.1.100:3000`

3. **測試同步**
   - 在電腦上進行操作
   - 觀察手機是否自動更新（最多 3 秒）

---

## 🔍 觀察同步狀態指示器

在頁面右下角，您會看到一個**實時同步狀態指示器**：

```
┌─────────────────────┐
│ 🛜 實時同步    🔄   │
│                     │
│ 狀態: 已連線        │
│ 下次更新: 3秒       │
│ 間隔: 3秒           │
│ 最後更新: 14:30:45  │
│                     │
│ ● 自動同步中        │
└─────────────────────┘
```

### 指示器說明

- **綠色 Wi-Fi 圖示** 🛜：網路已連線
- **紅色 Wi-Fi 圖示** 📡：網路已斷線
- **下次更新倒數**：顯示距離下次自動更新的秒數
- **手動刷新按鈕** 🔄：點擊立即更新資料
- **綠色閃爍燈** ●：表示自動同步正在運作中

---

## 🎯 測試項目清單

### ✅ 基本功能測試

- [ ] 視窗 A 新增隊員 → 視窗 B 自動顯示
- [ ] 視窗 A 刪除隊員 → 視窗 B 自動移除
- [ ] 視窗 A 新增場地 → 視窗 B 自動顯示
- [ ] 視窗 A 刪除場地 → 視窗 B 自動移除
- [ ] 視窗 A 將隊員加入場地 → 視窗 B 自動更新
- [ ] 視窗 A 將隊員移出場地 → 視窗 B 自動更新

### ✅ 進階測試

- [ ] 切換到其他應用程式後切回 → 自動更新
- [ ] 關閉 Wi-Fi 後重新連線 → 自動更新
- [ ] 手動點擊刷新按鈕 → 立即更新
- [ ] 觀察倒數計時是否正確

---

## 🎥 預期行為

### 正常情況
- 操作後 **最多 3 秒** 內，其他裝置會自動更新
- 不需要手動刷新頁面
- 狀態指示器顯示「自動同步中」

### 異常情況
- 如果超過 10 秒沒更新，檢查：
  - 網路連線是否正常
  - 服務器是否正在運行
  - 瀏覽器 Console 是否有錯誤訊息

---

## ⚙️ 調整同步間隔

如果覺得 3 秒太慢或太快，可以修改配置：

### 修改檔案：`src/config/realtimeConfig.js`

```javascript
export const realtimeConfig = {
  refetchInterval: 3000,  // 改成你想要的毫秒數
  // ...
};
```

### 建議值

| 需求 | 間隔時間 | 說明 |
|------|---------|------|
| 超高實時性 | 1000-2000 毫秒 (1-2秒) | 適合比賽進行時 |
| 高實時性 | 3000 毫秒 (3秒) | **預設值** ✅ |
| 一般需求 | 5000-10000 毫秒 (5-10秒) | 平衡性能 |
| 低頻更新 | 15000-30000 毫秒 (15-30秒) | 省電模式 |

修改後儲存檔案，瀏覽器會自動重新載入。

---

## 🐛 疑難排解

### 問題：更新沒有自動顯示

**解決方法：**
1. 檢查右下角狀態指示器是否顯示「自動同步中」
2. 檢查瀏覽器 Console 是否有錯誤訊息（按 F12 打開）
3. 確認服務器正在運行（`npm run dev`）
4. 嘗試手動點擊刷新按鈕

### 問題：更新速度太慢

**解決方法：**
```javascript
// 修改 src/config/realtimeConfig.js
export const realtimeConfig = {
  refetchInterval: 1000,  // 改為 1 秒
};
```

### 問題：請求太頻繁，伺服器壓力大

**解決方法：**
```javascript
// 修改 src/config/realtimeConfig.js
export const realtimeConfig = {
  refetchInterval: 10000,  // 改為 10 秒
};
```

### 問題：想要完全停用自動更新

**解決方法：**
```javascript
// 修改 src/config/realtimeConfig.js
export const realtimeConfig = {
  refetchInterval: false,  // 停用自動輪詢
};
```

---

## 📊 監控網路請求

### 查看請求頻率

1. 按 `F12` 打開瀏覽器開發者工具
2. 切換到 `Network` 標籤
3. 觀察每 3 秒是否有新的 API 請求：
   - `/api/courts`
   - `/api/members`
   - `/api/settings`

### 正常情況
- 每 3 秒會看到這些請求（狀態碼 200）
- 請求大小應該很小（幾 KB）
- 響應時間應該很快（<100ms）

---

## 🎉 成功標準

如果您看到以下情況，表示實時同步功能正常運作：

✅ 右下角狀態指示器顯示「自動同步中」
✅ 倒數計時正常運作
✅ 在 A 裝置操作後，B 裝置在 3 秒內自動更新
✅ 不需要手動刷新頁面
✅ 網路請求正常（每 3 秒一次）

---

## 📝 下一步

如果輪詢方案滿足您的需求，就可以直接使用了！

如果需要**更高的實時性（零延遲）**，可以參考 `REALTIME_SYNC.md` 中的 WebSocket 實現方案。

祝您使用愉快！ 🚀

